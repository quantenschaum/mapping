{
  "version": 8,
  "name": "Vector Test Tiles",
  "glyphs": "https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=L8FrrrJGE2n415wJo8BL",
  "sprite": "https://freenauticalchart.net/icons",
  "sources": {
    "bsh": {
      "type": "vector",
      "url": "pmtiles://https://freenauticalchart.net/vector.pmtiles",
      "minzoom": 6,
      "maxzoom": 16,
      "attribution": "<a href=\"https://freenauticalchart.net/download/\">QMAP</a>"
    }
  },
  "layers": [
    {
        "id": "depthareas",
        "type": "fill",
        "source": "bsh",
        "source-layer": "SkinOfTheEarth",
        "filter": ["any",["has","DRVAL1"],["has","land_type"]],
        "paint": {
          "fill-color": [ "case",
            [ "!", ["has", "DRVAL1"]], "#F9ECC0",
            [ "!", ["has", "DRVAL2"]], "#eee",
            [ "<", ["get", "DRVAL1"], 0 ], "#CADBC1",
            [ "<", ["get", "DRVAL1"], 2 ], "#AFCCE3",
            [ "<", ["get", "DRVAL1"], 5 ], "#CADEEF",
            [ "<", ["get", "DRVAL1"], 10 ], "#F1F6FC",
            "white" ],
          "fill-opacity": ["case",["has","DRVAL1"],1,0.5]
        }
    },
    {
        "id": "contourlines",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "has", "VALDCO" ],
        "paint": {
          "line-color": [ "case", [ "==", ["get", "VALDCO"], 2 ], "red", "gray" ],
          "line-width": [ "case", [ "==", ["get", "VALDCO"], 5 ], 1.6, 1 ]
        }
    },
    {
        "id": "contourlabels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "has", "VALDCO" ],
        "layout": {
         "text-field": "{VALDCO}",
         "text-size": 12,
         "text-anchor": "center",
         "symbol-placement": "line",
         "symbol-spacing": 200
        },
        "paint": {
          "text-color": "#444"
        }
    },
    {
        "id": "topo-areas",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["!=",["get","coast_type"],1],["!=",["get","land_type"],6]],
        "paint": {
          "fill-opacity": ["case",["==",["get","land_type"],11],0.2,0.6],
          "fill-color": ["case",
            ["==",["get","land_type"],1],"#ae9147",
            ["==",["get","land_type"],4],"#7cb6ea",
            ["==",["get","land_type"],7],"#a17d29",
            ["==",["get","land_type"],9],"#7cb6ea",
            ["==",["get","land_type"],11],"green",
            ["==",["get","coast_type"],2],"#c6a632",
            ["has","CATBRG"],"#cb9b35",
            ["has","facility_type"],"#ae9147",
            ["has","trans_type"],"#555",
            ["has","dock_type"],"#7cb6ea",
            "gray"]
        }
    },
    {
        "id": "topo-lines",
        "type": "line",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"]],
        "paint": {
          "line-color": ["case",
            ["==",["get","land_type"],7],"#0066d4",
            ["==",["get","land_type"],4],"brown",
            ["==",["get","caution_type"],4],"gray",
            ["==",["get","land_type"],8],"gray",
            ["==",["get","util_type"],8],"gray",
            ["==",["get","trans_type"],2],"#0066d4",
            "black"],
          "line-width": ["case",
            ["==",["get","land_type"],7],1.5,
            ["==",["get","trans_type"],2],3,
            ["==",["get","land_type"],2],3,
            ["==",["get","CATSLO"],6],2,
            ["==",["get","CATSLC"],2],1.5,
            ["==",["get","CATSLC"],9],2,
            ["==",["get","CATSLC"],10],2.5,
            1]
        }
    },
    {
        "id": "topo-cliffs",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"],[">",["get","uband"],3],["==",["get","CATSLO"],6]],
        "layout": {
          "icon-image": "cliff",
          "icon-overlap": "always",
          "icon-offset": [0,-3],
          "icon-rotate": 180,
          "symbol-placement": "line",
          "symbol-spacing": 10
        },
        "paint": {
        }
    },
    {
        "id": "TSS-inshore-traffic-zone",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATTSS"],["==",["get","zone_type"],4]],
        "paint": {
          "line-color": "magenta",
          "line-dasharray": [1,4],
          "line-opacity": 0.8
        }
    },
    {
        "id": "TSS-separation-zone",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATTSS"],["==",["get","zone_type"],11]],
        "paint": {
          "fill-color": "magenta",
          "fill-opacity": 0.2
        }
    },
    {
        "id": "TSS-crossing-zone",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATTSS"],["==",["get","zone_type"],8]],
        "paint": {
          "fill-color": "yellow",
          "fill-opacity": 0.1
        }
    },
    {
        "id": "TSS-separation-lane",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATTSS"],["==",["get","zone_type"],9]],
        "paint": {
          "fill-color": "yellow",
          "fill-opacity": 0.05
        }
    },
    {
        "id": "TSS-separation-lane-arrows",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATTSS"],["==",["get","zone_type"],9]],
        "layout": {
          "icon-image": "TSS-arrow",
          "icon-size": 0.6,
          "icon-rotate": ["get","ORIENT"],
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "TSS-separation-boundary",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"],["has","CATTSS"],["==",["get","zone_type"],7]],
        "paint": {
          "line-color": "magenta",
          "line-width": 2,
          "line-dasharray": [4,4],
          "line-opacity": 0.8
        }
    },
    {
        "id": "TSS-separation-line",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"],["has","CATTSS"],["==",["get","zone_type"],6]],
        "paint": {
          "line-color": "magenta",
          "line-width": 2,
          "line-opacity": 0.8
        }
    },
    {
        "id": "traffic-lane",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["==",["get","zone_type"],7]],
        "paint": {
          "fill-color": "yellow",
          "fill-opacity": 0.05
        }
    },
    {
        "id": "traffic-lane-arrows",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["==",["get","zone_type"],7]],
        "layout": {
          "icon-image": "TSS-arrow-dashed",
          "icon-size": 0.6,
          "icon-rotate": ["get","ORIENT"],
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "piles",
        "type": "circle",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["any",["has","CATPLE"],["has","CATMOR"]]],
        "paint": {
          "circle-radius": 3
        }
    },
    {
        "id": "dir-of-buoyage",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],[ "has", "ORIENT" ],["==",["get","meta_type"],6]],
        "layout": {
          "icon-image": "dir-buoyage-a",
          "icon-rotate": ["get","ORIENT"],
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.5
        }
    },
    {
        "id": "harhours",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["any",["has","CATHAF"]]],
        "layout": {
          "icon-image": ["case",
            ["in",5,["get","CATHAF"]],"marina",
            ["in",4,["get","CATHAF"]],"fishingharbour",
            ""],
          "icon-overlap": "always",
          "text-field": "{OBJNAM}",
          "text-size": 12,
          "text-anchor": "top",
          "text-optional": true,
          "text-offset": [0,1.2]
        },
        "paint": {
          "text-color": "magenta"
        }
    },
    {
        "id": "platforms",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["has", "CATOFP"]],
        "layout": {
         "icon-image": "platform",
         "icon-overlap": "always"
        }
    },
    {
        "id": "rocks-dangerous",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "RocksWrecksObstructions",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["==", ["get","caution_type"], 6],["==", ["get","EXPSOU"], 2]],
        "layout": {
         "icon-image": "obstruction",
         "icon-overlap": "always"
        }
    },
    {
        "id": "rocks",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "RocksWrecksObstructions",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["==", ["get","caution_type"], 6]],
        "layout": {
         "icon-image": ["concat","rock-",["case",
            ["==",["get","WATLEV"],4],"covers",
            ["==",["get","WATLEV"],5],"awash",
            "submerged"]],
         "icon-overlap": "always",
         "text-field": "({VALSOU})",
         "text-size": ["case",["has","VALSOU"],12,0],
         "text-anchor": "top",
         "text-optional": true,
         "text-offset": [0,0.6]
        },
        "paint": {
          "text-color": ["case", ["<",5,["get","VALSOU"]],"gray", "black"]
        }
    },
    {
        "id": "obstructions",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "RocksWrecksObstructions",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["!=", ["get","caution_type"], 6]],
        "layout": {
         "icon-image": ["case",
           ["==",["get","CATWRK"],1],"wreck-non-dangerous",
           ["==",["get","CATWRK"],2],"wreck-dangerous",
           ["==",["get","CATWRK"],4],"wreck-hull_showing",
           ["==",["get","CATWRK"],5],"wreck-hull_showing",
           ["==",["get","CATOBS"],6],"foul",
           ["==",["get","CATOBS"],7],"foul",
           "obstruction"],
         "icon-overlap": "always",
         "text-field": "({VALSOU})",
         "text-size": ["case",["has","VALSOU"],12,0],
         "text-anchor": "top",
         "text-optional": true,
         "text-offset": [0,0.8]
        },
        "paint": {
          "text-color": ["case", ["<",5,["get","VALSOU"]],"gray", "black"]
        }
    },
    {
        "id": "lights",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],
          ["!",["any",["has","ORIENT"],["all",["has","SECTR1"],["has","SECTR2"]]]]],
        "layout": {
          "icon-image": ["concat",
            ["case",["in",8,["get","CATLIT"]],"floodlight/","light/"],
            ["case",["has","color"],["get","color"],"generic"]],
          "icon-rotate": ["+",45,["case",
            ["in",3,["get","COLOUR"]],10,
            ["in",4,["get","COLOUR"]],-10
            ,0]],
          "icon-overlap": "always",
          "icon-rotation-alignment": "viewport"
        }
    },
    {
        "id": "lights-oriented",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],
          ["any",["has","ORIENT"],["all",["has","SECTR1"],["has","SECTR2"]]]],
        "layout": {
          "icon-image": ["concat",
            ["case",["in",8,["get","CATLIT"]],"floodlight/","light/"],
            ["case",["has","color"],["get","color"],"generic"]],
          "icon-rotate": ["case",
            ["has","ORIENT"],["get","ORIENT"],
            ["all",["has","SECTR1"],["has","SECTR2"]],
              ["let","angle",
                ["case",[">=",["get","SECTR2"],["get","SECTR1"]],
                  ["-",["get","SECTR2"],["get","SECTR1"]],
                  ["+",["-",["get","SECTR2"],["get","SECTR1"]],360]],
                ["+",["get","SECTR1"],["/",["var","angle"],2]]],
                0],
          "icon-overlap": "always",
          "icon-rotation-alignment": "map"
        }
    },
    {
        "id": "lights-sector1",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ "has", "SECTR1" ],[">=",["zoom"],10]],
        "layout": {
          "icon-image": "line-dashed",
          "icon-rotate": ["get","SECTR1"],
          "icon-offset": [0,256],
          "icon-size": ["*",["case",["==",["get","EXCLIT"],3],0.5,1],["interpolate",["linear"],["coalesce",["get","VALNMR"],99],3,0.6,10,1]],
          "icon-overlap": "always",
          "icon-pitch-alignment": "map",
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.7
        }
    },
    {
        "id": "lights-sector2",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ "has", "SECTR2" ],[">=",["zoom"],10]],
        "layout": {
          "icon-image": "line-dashed",
          "icon-rotate": ["get","SECTR2"],
          "icon-offset": [0,256],
          "icon-size": ["*",["case",["==",["get","EXCLIT"],3],0.5,1],["interpolate",["linear"],["coalesce",["get","VALNMR"],99],3,0.6,10,1]],
          "icon-overlap": "always",
          "icon-pitch-alignment": "map",
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.7
        }
    },
    {
        "id": "lights-arc-0",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ "has", "SECTR1" ],[ "has", "SECTR2" ],[">=",["zoom"],10]],
        "layout": {
          "icon-image": ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
              ["concat","arc-",["step",["var","angle"],-1,0,0,4.444,1,13.333,2,40,3,120,4],"-",["get","color"]]],
          "icon-rotate": ["get","SECTR1"],
          "icon-size": ["*",["case",["==",["get","EXCLIT"],3],0.5,1],["interpolate",["linear"],["coalesce",["get","VALNMR"],99],3,0.6,10,1],
              ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
                  ["interpolate",["linear"],["var","angle"],0,3,6,1]] ],
          "icon-overlap": "always",
          "icon-pitch-alignment": "map",
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "lights-arc-1",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ "has", "SECTR1" ],[ "has", "SECTR2" ],[">=",["zoom"],10]],
        "layout": {
          "icon-image": ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
              ["concat","arc-",["step",["var","angle"],-1,0,0,4.444,1,13.333,2,40,3,120,4],"-",["get","color"]]],
          "icon-rotate": ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]], ["+",["get","SECTR1"],["*",["var","angle"],0.5],["step",["var","angle"],-1,0,-0.741,4.444,-2.222,13.333,-6.666,40,-20,120,-60]]],
          "icon-size": ["*",["case",["==",["get","EXCLIT"],3],0.5,1],["interpolate",["linear"],["coalesce",["get","VALNMR"],99],3,0.6,10,1],
              ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
                  ["interpolate",["linear"],["var","angle"],0,3,6,1]]],
          "icon-overlap": "always",
          "icon-pitch-alignment": "map",
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "lights-arc-3",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ "has", "SECTR1" ],[ "has", "SECTR2" ],[">=",["zoom"],10]],
        "layout": {
          "icon-image": ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
              ["concat","arc-",["step",["var","angle"],-1,0,0,4.444,1,13.333,2,40,3,120,4],"-",["get","color"]]],
          "icon-rotate": ["-",["get","SECTR2"],["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],["step",["var","angle"],-1,0,1.481,4.444,4.444,13.333,13.333,40,40,120,120]]],
          "icon-size": ["*",["case",["==",["get","EXCLIT"],3],0.5,1],["interpolate",["linear"],["coalesce",["get","VALNMR"],99],3,0.6,10,1],
              ["let","angle", ["+",["-",["get","SECTR2"],["get","SECTR1"]],["case",[">=",["get","SECTR2"],["get","SECTR1"]],0,360]],
                  ["interpolate",["linear"],["var","angle"],0,3,6,1]] ],
          "icon-overlap": "always",
          "icon-pitch-alignment": "map",
          "icon-rotation-alignment": "map"
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "lights-full",
        "type": "circle",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],[ ">", ["get","VALNMR"],15 ],["!",["has","ORIENT"]],["!",["has","SECTR1"]],[">=",["zoom"],10]],
        "layout": {
        },
        "paint": {
          "circle-radius": ["step",["get","VALNMR"],0,0,40,20,60],
          "circle-opacity": 0,
          "circle-stroke-width": 5,
          "circle-stroke-opacity": 0.7,
          "circle-stroke-color": ["match",["get","COLOUR"],
            "1","#fab20b",
            "3","#ed1c24",
            "4","#00a650",
            "6","#fab20b",
            "11","#fab20b",
            "#800080"],
          "circle-pitch-alignment": "map"
        }
    },
    {
        "id": "light-stars",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["has","VALNMR"]],
        "layout": {
          "icon-image": ["case",[">",["get","VALNMR"],10],"light-major","light-minor"],
          "icon-overlap": "always"
        }
    },
    {
        "id": "fogsignals",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["has","CATFOG"]],
        "layout": {
          "icon-image": "fogsignal",
          "icon-overlap": "always"
        }
    },
    {
        "id": "radar-reflectors",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["==",["get","CONRAD"],3]],
        "layout": {
          "icon-image": "radar-reflector",
          "icon-rotate": -60,
          "icon-offset": [0,-8],
          "icon-overlap": "always"
        }
    },
    {
        "id": "topmarks",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["any",["has","TOPSHP"],["has","BOYSHP"],["has","BCNSHP"]]],
        "layout": {
          "icon-image": ["case",
              ["all",["has","BOYSHP"],["==",["get","color"],"RW"]],"sphere/red",
              ["all",["has","BOYSHP"],["==",["get","color"],"BRB"]],"2_spheres/black",
              ["all",["has","BCNSHP"],["==",["get","color"],"BRB"]],"2_spheres/black",
              ["all",["has","BOYSHP"],["==",["get","CATLAM"],2],["==",["get","OBJNAM"],"1"]],"cone_point_up/green",
              ["all",["has","BOYSHP"],["==",["get","CATLAM"],1],["==",["get","OBJNAM"],"2"]],"cylinder/red",
              ["==",["get","CATSPM"],"46"],"flag/generic",
              ["==",["get","CATCAM"],1],"2_cones_up/black",
              ["==",["get","CATCAM"],2],"2_cones_base_together/black",
              ["==",["get","CATCAM"],3],"2_cones_down/black",
              ["==",["get","CATCAM"],4],"2_cones_point_together/black",
              ["concat","TOPSHP","/",["get","TOPSHP"],"/",["coalesce",["get","COLPAT"],0],"/",["coalesce",["get","color"],0]]],
          "icon-overlap": "always",
          "icon-offset": ["case",
              ["has","TOPSHP"],["literal",[0,-20]],
              ["has","BCNSHP"],["literal",[0,-19]],
              ["==",["get","BOYSHP"],1],["literal",[0,-12]],
              ["==",["get","BOYSHP"],2],["literal",[0,-8]],
              ["==",["get","BOYSHP"],3],["literal",[0,-9]],
              ["literal",[0,-22]]],
          "icon-rotate": ["case",["all",["has","BOYSHP"],["!",["in",["get","BOYSHP"],["literal",[6,7]]]]],15,0],
          "icon-size": ["case",["any",["has","BOYSHP"],["has","BCNSHP"]],1,1.2]
        }
    },
    {
        "id": "buoys",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "has", "BOYSHP" ],
        "layout": {
          "icon-image": ["concat","BOYSHP","/",["get","BOYSHP"],"/",["coalesce",["get","COLPAT"],0],"/",["coalesce",["get","color"],0]],
          "icon-overlap": "always",
           "text-size": 10,
           "text-offset": [0,1],
           "text-optional": true
        }
    },
    {
        "id": "beacons",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "has", "BCNSHP" ],
        "layout": {
          "icon-image": ["case",
            ["all",["==",["get","BCNSHP"],1],["==",["get","CATLAM"],2],["!",["has","COLOUR"]]],"perch-starboard",
            ["all",["==",["get","BCNSHP"],1],["==",["get","CATLAM"],1],["!",["has","COLOUR"]]],"perch-port",
            ["all",["==",["get","BCNSHP"],2],["==",["get","CATLAM"],2],["!",["has","COLOUR"]]],"withy-starboard",
            ["all",["==",["get","BCNSHP"],2],["==",["get","CATLAM"],1],["!",["has","COLOUR"]]],"withy-port",
            ["concat","BCNSHP","/",["get","BCNSHP"],"/",["coalesce",["get","COLPAT"],0],"/",["coalesce",["get","color"],0]]],
          "icon-overlap": "always",
           "text-size": 10,
           "text-offset": [0,1],
           "text-optional": true
        }
    },
    {
        "id": "landmarks",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"], ["has", "CATLMK"]],
        "layout": {
          "icon-image": ["case",
          ["in",20,["get","FUNCTN"]],"church",
          ["in",21,["get","FUNCTN"]],"church",
          ["all",["in",17,["get","CATLMK"]],["has","color"]],
              ["concat","BCNSHP/3/",["coalesce",["get","COLPAT"],0],"/",["coalesce",["get","color"],0]],
          ["concat","CATLMK/",["get","CATLMK"]]],
          "icon-overlap": "always",
          "text-field": "{OBJNAM}",
          "text-size": 12,
         "text-font": ["Open Sans Bold"],
          "text-anchor": "bottom-left",
          "text-offset": [1.2,-1.2],
          "text-optional": true
        }
    },
    {
        "id": "magnetic-variation",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["has","VALMAG"]],
        "layout": {
          "text-field": "{label}",
          "text-font": ["Open Sans Bold"],
          "text-size": 12
        },
        "paint": {
          "text-color": "magenta"
        }
    },
    {
        "id": "navigation-lines",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"],["has","CATNAV"]],
        "layout": {
        },
        "paint": {
          "line-color": "black",
          "line-width": 0.8,
          "line-dasharray": [4,2]
        }
    },
    {
        "id": "navigation-tracks",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"],["has","CATTRK"]],
        "paint": {
          "line-color": "gray",
          "line-width": 1
        }
    },
    {
        "id": "cables-pipes-sym",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "LineString"], ["has", "util_type"]],
        "layout": {
          "icon-image": ["case",["has","CATPIP"],"pipeline","cable"],
          "icon-overlap": "always",
          "symbol-placement": "line",
          "symbol-spacing": 25
        }
    },
    {
        "id": "restricted-areas",
        "type": "line",
        "source": "bsh",
        "source-layer": "-Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["any",["has","RESTRN"],["has","CATMPA"],["has","CATCBL"],["has","CATPRA"],["has","CATREA"],["has","util_type"]]],
        "paint": {
          "line-color": ["case",
            ["in",7,["get","RESTRN"]],"magenta",
            ["in",4,["get","CATREA"]],"green",
            ["in",5,["get","CATREA"]],"green",
            ["in",6,["get","CATREA"]],"green",
            ["in",7,["get","CATREA"]],"green",
            ["in",22,["get","CATREA"]],"green",
            ["in",23,["get","CATREA"]],"green",
            ["in",27,["get","CATREA"]],"green",
            ["in",28,["get","CATREA"]],"green",
            "magenta"],
          "line-dasharray": [4,2],
          "line-opacity": 0.8
        }
    },
    {
        "id": "restricted-areas-sym",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["any",["has","RESTRN"],["has","CATMPA"],["has","CATCBL"],["has","CATPRA"],["has","CATREA"],["has","util_type"]]],
        "layout": {
          "icon-image": ["case",
            ["in",7,["get","RESTRN"]],"area-m",
            ["in",4,["get","CATREA"]],"area-g",
            ["in",5,["get","CATREA"]],"area-g",
            ["in",6,["get","CATREA"]],"area-g",
            ["in",7,["get","CATREA"]],"area-g",
            ["in",22,["get","CATREA"]],"area-g",
            ["in",23,["get","CATREA"]],"area-g",
            ["in",27,["get","CATREA"]],"area-g",
            ["in",28,["get","CATREA"]],"area-g",
            "area-m"],
          "icon-overlap": "always",
          "symbol-placement": "line",
          "symbol-spacing": 25
        },
        "paint": {
          "icon-opacity": 0.5
        }
    },
    {
        "id": "restricted-areas-no-entry",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["in",7,["get","RESTRN"]]],
        "paint": {
          "fill-color": "red",
          "fill-opacity": 0.05
        }
    },
    {
        "id": "restricted-areas-restricted-entry",
        "type": "fill",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["in",8,["get","RESTRN"]]],
        "paint": {
          "fill-color": "yellow",
          "fill-opacity": 0.03
        }
    },
    {
        "id": "restricted-no-anchor",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["any",["has","RESTRN"]]],
        "layout": {
          "icon-image": ["case",
            ["in",11,["get","RESTRN"]],"no-diving",
            ["in",1,["get","RESTRN"]],"no-anchor",
            ["in",3,["get","RESTRN"]],"no-fishing",
            "xxx"],
          "icon-overlap": "always",
          "symbol-placement": "line",
          "symbol-spacing": 100
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "restricted-area-names",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["any",["has","RESTRN"],["has","CATMPA"],["has","CATCBL"],["has","CATPRA"],["has","CATREA"],["has","util_type"],["has","CATACH"]]],
        "layout": {
          "text-field": "{OBJNAM}",
          "text-size": 12
        },
        "paint": {
          "text-color": ["case",
            ["in",7,["get","RESTRN"]],"magenta",
            ["in",4,["get","CATREA"]],"green",
            ["in",5,["get","CATREA"]],"green",
            ["in",6,["get","CATREA"]],"green",
            ["in",7,["get","CATREA"]],"green",
            ["in",22,["get","CATREA"]],"green",
            ["in",23,["get","CATREA"]],"green",
            ["in",27,["get","CATREA"]],"green",
            ["in",28,["get","CATREA"]],"green",
            "magenta"]
        }
    },
    {
        "id": "marine-farm",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATMFA"]],
        "paint": {
          "line-color": ["case",["==",["get","CATMFA"],2],"magenta","black"],
          "line-dasharray": [4,4],
          "line-opacity": 0.8
        }
    },
    {
        "id": "marine-farm-shellfish",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["==",["get","CATMFA"],2]],
        "layout": {
          "icon-image": "shellfish",
          "icon-overlap": "always",
          "icon-size": 0.8,
          "symbol-placement": "line",
          "symbol-spacing": 90
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "marine-farm-general",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATMFA"],["!=",["get","CATMFA"],2]],
        "layout": {
          "icon-image": "marine-farm",
          "icon-overlap": "always",
          "icon-size": 0.8,
          "symbol-spacing": 90
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "anchorages",
        "type": "line",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATACH"]],
        "paint": {
          "line-color": "magenta",
          "line-dasharray": [4,4],
          "line-opacity": 0.8
        }
    },
    {
        "id": "anchorages-sym",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATACH"]],
        "layout": {
          "icon-image": "anchor",
          "icon-overlap": "always",
          "icon-size": 0.6,
          "symbol-placement": "line",
          "symbol-spacing": 100
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "military-sym",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","CATMPA"]],
        "layout": {
          "icon-image": "military",
          "icon-overlap": "always",
          "icon-size": 0.8,
          "symbol-placement": "line",
          "symbol-spacing": 120
        },
        "paint": {
          "icon-opacity": 0.8
        }
    },
    {
        "id": "charts",
        "type": "line",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],[ "has", "MARSYS" ]],
        "layout": {
        },
        "paint": {
         "line-color": "gray",
         "line-dasharray": [2,2]
        }
    },
    {
        "id": "chart-labels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],[ "has", "MARSYS" ]],
        "layout": {
          "text-field": "{name}",
          "text-anchor": "top",
          "text-size": 12,
          "symbol-placement": "line"
        },
        "paint": {
          "text-color": "gray"
        }
    },
    {
        "id": "seabed",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Hydrography",
        "filter": [ "all", ["==", ["geometry-type"], "Point"]],
        "layout": {
          "icon-image": ["case",
            ["any",[">",["get","CATWED"],2]],"seagrass",
            ["any",["has","CATWED"],["==",["get","caution_type"],8]],"kelp",
            "kelp"],
          "text-field": ["case",
            ["has","CATWED"],["match",["get","CATWED"],1,"Ke",2,"Wd",3,"Sg",4,"Sa",""],
            ["concat",
            ["match",["get","NATQUA"],
                "1", "f",
                "2", "m",
                "3", "c",
                "4", "brk",
                "5", "stk",
                "6", "so",
                "7", "stf",
                "8", "vol",
                "9", "ca",
               "10", "h",
               ""],
            ["match",["get","NATSUR"],
               "1", "M",
               "1/4", "M/S",
               "2", "Cy",
               "3", "Si",
               "4", "S",
               "4/1", "S/M",
               "4/5", "S/St",
               "4/6", "S/G",
               "4/7", "S/P",
               "4/8", "S/Cb",
               "5", "St",
               "6", "G",
               "7", "P",
               "7,8", "P/Cb",
               "7/8", "P/Cb",
               "8", "Cb",
               "8,7", "Cb/P",
               "8/7", "Cb/P",
               "9", "R",
              "11", "La",
              "14", "Co",
              "17", "Sh",
              "18", "Bo",
            ""]]
            ],
          "text-anchor": "top",
          "text-size": 12,
          "text-optional": true,
          "icon-offset": [0,-6]
        },
        "paint": {
          "text-color": "gray"
        }
    },
    {
        "id": "spot-soundings",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "SOUNDG",
        "layout": {
         "text-field": [
              "let", "val", ["get", "VALSOU"],
              [
                "let", "isNegative", ["<", ["var", "val"], 0],
                [
                  "let", "absVal", ["*", ["var", "val"], ["case", ["var", "isNegative"], -1, 1]],
                  [
                    "let", "valTimes10", ["floor", ["*", ["var", "absVal"], 10]],
                    [
                      "let", "valStr", ["to-string", ["var", "valTimes10"]],
                      [
                        "let", "len", ["length", ["var", "valStr"]],
                        [
                          "let", "intPart",
                            [
                              "case",
                              ["<", ["var", "len"], 2],
                              "0",
                              ["slice", ["var", "valStr"], 0, ["-", ["var", "len"], 1]]
                            ],
                          [
                            "let", "decDigit", ["slice", ["var", "valStr"], ["-", ["var", "len"], 1], ["var", "len"]],
                            [
                              "let", "subDigit",
                                [
                                  "match",
                                  ["var", "decDigit"],
                                  "0", "",
                                  "1", "₁",
                                  "2", "₂",
                                  "3", "₃",
                                  "4", "₄",
                                  "5", "₅",
                                  "6", "₆",
                                  "7", "₇",
                                  "8", "₈",
                                  "9", "₉",
                                  "x"
                                ],
                              [
                                "concat",
                                ["case", ["var", "isNegative"], "-", ""],
                                ["var", "intPart"],
                                ["var", "subDigit"]
                              ]
                            ]
                          ]
                        ]
                      ]
                    ]
                  ]
                ]
              ]
            ],
         "text-size": 14,
         "text-anchor": "center"
        },
        "paint": {
          "text-color": ["case", [">",0,["get","VALSOU"]],"green", ["<",5,["get","VALSOU"]],"gray", "black"]
        }
    },
    {
        "id": "deptharea-label",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "SkinOfTheEarth",
        "filter": ["all",["has","DRVAL1"],["!",["has","DRVAL2"]]],
        "layout": {
          "text-field": ["concat",["case",["==",["get","QUASOU"],10],"maintained depth ",""],["get","DRVAL1"],"m"],
          "text-size": 12
        },
        "paint": {
          "text-opacity": 0.8
        }
    },
    {
        "id": "topo-labels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "Polygon"],["has","OBJNAM"]],
        "layout": {
          "text-field": "{OBJNAM}",
         "text-size": 14,
         "text-font": ["Open Sans Italic"]
        },
        "paint": {
          "text-color": "gray"
        }
    },
    {
        "id": "berth-labels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "Topography",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["has","berth_type"],["has","OBJNAM"]],
        "layout": {
          "text-field": "{OBJNAM}",
          "text-size": 12
        },
        "paint": {
          "text-color": "magenta"
        }
    },
    {
        "id": "buoy-labels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],["any",[ "has", "BOYSHP" ],[ "has", "BCNSHP" ]]],
        "layout": {
         "text-field": "{OBJNAM}",
         "text-size": 12,
         "text-font": ["Open Sans Bold"],
         "text-anchor": "bottom-left",
         "text-offset": [1.2,-1]
        },
        "paint": {
        }
    },
    {
        "id": "light-labels",
        "type": "symbol",
        "source": "bsh",
        "source-layer": "AidsAndServices",
        "filter": [ "all", ["==", ["geometry-type"], "Point"],[ "has", "LITCHR" ],["!",["in",8,["get","CATLIT"]]]],
        "layout": {
         "text-field": ["concat",
            ["match",["get","LITCHR"],
               1, "F",
               2, "Fl",
               3, "LFl",
               4, "Q",
               5, "VQ",
               6, "UQ",
               7, "Iso",
               8, "Oc",
               9, "IQ",
              10, "IVQ",
              11, "IUQ",
              12, "Mo",
              13, "FFl",
              14, "FlLFl",
              15, "OcFl",
              16, "FLFl",
              17, "Al.Oc",
              18, "Al.LFl",
              19, "Al.Fl",
              20, "Al.Gr",
              25, "Q+LFl",
              26, "VQ+LFl",
              27, "UQ+LFl",
              28, "Al",
              29, "Al.FFl",
              "??" ],
            ["case",["all",["!=",["get","SIGGRP"],"(1)"],["!=",["get","SIGGRP"],"()"]],["get","SIGGRP"],
                ["case",["any",["==",["get","color"],"W"],["has","SECTR1"]],"","."]],
            ["case",["any",["==",["get","color"],"W"],["has","SECTR1"]],"",["concat",["get","color"]]],
            ["case",["has","SIGPER"],["concat"," ",["get","SIGPER"],"s"],""],
            ["case",["has","HEIGHT"],["concat"," ",["get","HEIGHT"],"m"],""],
            ["case",["has","VALNMR"],["concat"," ",["get","VALNMR"],"M"],""]
            ],
         "text-size": 12,
         "text-anchor": "top-left",
         "text-offset": ["case",["has","SECTR1"],["literal",[1.2,1.1]],["literal",[1.2,-0.5]]]
        }
    }
  ]
}
